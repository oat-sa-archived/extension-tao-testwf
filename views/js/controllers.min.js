define("taoWfTest/controller/routes",[],function(){return{Authoring:{actions:{index:"controller/authoring"}}}}),define("taoWfTest/controller/authoring",["module","jquery","lodash","i18n","generis.tree.select","helpers","ui/feedback"],function(module,$,_,__,GenerisTreeSelectClass,helpers,feedback){var Controller={start:function(options){var self=this,$sequenceContainer=$("#item-sequence");options=_.merge(module.config(),options||{});var sequence=options.sequence||[],newSequence={},labels=options.labels||{};new GenerisTreeSelectClass("#item-tree",helpers._url("getTreeData","Items","taoWfTest"),{actionId:"item",saveUrl:options.saveurl,paginate:10,saveCallback:function(data){newSequence={},sequence=[];
var uris=$.parseJSON(data.instances);for(var attr in uris)-1===$.inArray(uris[attr],sequence)&&void 0!==attr&&(newSequence[parseInt(attr.replace("instance_",""))+1]="item_"+uris[attr],sequence[parseInt(attr.replace("instance_",""))+1]=uris[attr]);self._buildItemList($sequenceContainer,newSequence,labels)},checkedNodes:sequence,serverParameters:{openNodes:options.openNodes,rootNode:options.rootNode},callback:{checkPaginate:function(){this.check(sequence)}}}),$sequenceContainer.on("mouseover","li",function(){$(this).css("cursor","grab")}).on("mousedown","li",function(){$(this).css("cursor","grabbing")}).on("mouseup","li",function(){$(this).css("cursor","pointer")
}),$sequenceContainer.sortable({axis:"y",opacity:.6,placeholder:"placeholder",tolerance:"pointer",update:function(){var index,listItems=$(this).sortable("toArray");newSequence={},sequence=[];for(var i=0;i<listItems.length;i++)index=i+1,newSequence[index]=listItems[i],sequence[index]=listItems[i].replace("item_","");self._buildItemList($sequenceContainer,newSequence,labels)}}),$(".sequence-container .saver").click(function(){var toSend={};for(var index in sequence)toSend["instance_"+index]=sequence[index];toSend.uri=$("input[name=uri]").val(),toSend.classUri=$("input[name=classUri]").val(),$.ajax({url:options.saveurl,type:"POST",data:toSend,dataType:"json",success:function(response){response.saved&&feedback().success(__("Sequence saved successfully"))
},complete:function(){helpers.loaded()}})})},_buildItemList:function($container,items,labels){var itemId,html="";for(var i in items)itemId=items[i],html+="<li class='ui-state-default' id='"+itemId+"' >",html+=i+". "+labels[itemId],html+="</li>";$container.html(html)}};return Controller});
//# sourceMappingURL=routes.js.map