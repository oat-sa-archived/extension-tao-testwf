define("taoWfTest/controller/routes",[],function(){return{}}),define("taoWfTest/controller/authoring",["module","jquery","lodash","i18n","generis.tree.select","helpers"],function(e,t,a,n,i,s){var r={start:function(r){var o=this,c=t("#item-sequence"),l=t("#item-sequence").prev(".elt-info");r=a.merge(e.config(),r||{});var u=r.sequence||[],d={},f=r.labels||{};new i("#item-tree",s._url("getTreeData","Items","taoWfTest"),{actionId:"item",saveUrl:r.saveurl,paginate:10,saveCallback:function(e){d={},u=[];var a=t.parseJSON(e.instances);for(var n in a)-1===t.inArray(a[n],u)&&void 0!==n&&(d[parseInt(n.replace("instance_",""))+1]="item_"+a[n],u[parseInt(n.replace("instance_",""))+1]=a[n]);o._buildItemList(c,d,f),t("li",c).length?l.show():l.hide()},checkedNodes:u,serverParameters:{openNodes:r.openNodes,rootNode:r.rootNode},callback:{checkPaginate:function(){this.check(u)}}}),c.sortable({axis:"y",opacity:.6,placeholder:"ui-state-error",tolerance:"pointer",update:function(){var e,a=t(this).sortable("toArray");d={},u=[];for(var n=0;n<a.length;n++)e=n+1,d[e]=a[n],u[e]=a[n].replace("item_","");o._buildItemList(c,d,f)}}),c.on("mousedown","li",function(){t(this).css("cursor","move")}).on("mouseup","li",function(){t(this).css("cursor","pointer")}),t("#saver-action-item-sequence").click(function(){var e={};for(var a in u)e["instance_"+a]=u[a];e.uri=t("input[name=uri]").val(),e.classUri=t("input[name=classUri]").val(),t.ajax({url:r.saveurl,type:"POST",data:e,dataType:"json",success:function(e){e.saved&&s.createInfoMessage(n("Sequence saved successfully"))},complete:function(){s.loaded()}})})},_buildItemList:function(e,t,a){var n,i="";for(var s in t)n=t[s],i+="<li class='ui-state-default' id='"+n+"' >",i+="<span class='ui-icon ui-icon-arrowthick-2-n-s' /><span class='ui-icon ui-icon-grip-dotted-vertical' />",i+=s+". "+a[n],i+="</li>";e.html(i)}};return r});